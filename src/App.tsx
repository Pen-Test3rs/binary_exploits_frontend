import './App.css';
import { Route, Switch, withRouter } from 'react-router-dom';
import LoginComponent from './components/login/loginComponent';
import React from 'react';
import NavbarComponent from './components/navbar/navbarComponent';
import withContainer from './components/container/container';
import DashboardComponent from './components/dashboard/dashboardComponent';
import RegisterComponent from './components/register/registerComponent';
import withToasts from './components/toast/toastComponent';
import { compose } from 'redux';
import withAppContext from './context/appContext';
import LogoutComponent from './components/logout/logoutComponent';
import ArticlesComponent from './components/articles/articlesComponent';
import UserProfileComponent from './components/profile/userProfileComponent';
import PrivateRoute from './components/shared/privateRoute';

//TODO: private routes with auth checking
//TODO: login/register blocking when user is logged/registered

const loginNeededText = 'You have to be logged in!';

const AppInternal = () => {
    return (
        <>
            <NavbarComponent />
            <Switch>
                <Route exact path={'/'} />

                <PrivateRoute redirectPath={'/dashboard'} reverse exact path={'/login'} component={LoginComponent} />

                <PrivateRoute
                    redirectPath={'/dashboard'}
                    reverse
                    exact
                    path={'/register'}
                    component={RegisterComponent}
                />

                <Route exact path={'/dashboard'} component={DashboardComponent} />

                <PrivateRoute redirectPath={'/dashboard'} exact path={'/logout'} component={LogoutComponent} />

                <PrivateRoute
                    redirectPath={'/login'}
                    redirectText={loginNeededText}
                    exact
                    path={'/profile'}
                    component={UserProfileComponent}
                />

                <Route exact path={'/articles'} component={ArticlesComponent} />
            </Switch>
        </>
    );
};

const App = compose(withAppContext, withRouter, withContainer, withToasts)(AppInternal);

export default App;
