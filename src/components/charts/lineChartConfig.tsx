import { ChartConfiguration, ChartDataset, ChartType } from 'chart.js';
import { pl } from 'date-fns/locale';

interface CustomChartData {
    date: Date;
    points: number;
}

export const getConfig = (
    datasets: ChartDataset<ChartType, CustomChartData[]>[],
    displayLegend: boolean
): ChartConfiguration<ChartType, CustomChartData[]> => {
    return {
        type: 'line',
        data: {
            datasets: datasets
        },
        options: {
            maintainAspectRatio: false,
            responsive: true,
            plugins: {
                legend: {
                    display: displayLegend,
                    labels: {
                        color: 'black'
                    },
                    align: 'end',
                    position: 'bottom'
                },
                title: {
                    display: false,
                    text: 'Postępy w czasie',
                    color: 'black'
                },
                tooltip: {
                    mode: 'nearest',
                    intersect: false
                }
            },
            hover: {
                mode: 'nearest',
                intersect: false
            },
            elements: {
                point: {
                    radius: 4,
                    hoverRadius: 6
                }
            },
            scales: {
                x: {
                    type: 'time',
                    adapters: {
                        date: {
                            locale: pl,
                            timeFormat: '24hours'
                        }
                    },
                    time: {
                        tooltipFormat: 'dd MMM yyyy, HH:mm',
                        displayFormats: {
                            hour: 'HH:mm',
                            day: 'dd MMM'
                        },
                        round: 'minute'
                    },
                    ticks: {
                        source: 'auto',
                        color: 'rgba(0,0,0,.7)'
                    },
                    display: true,
                    title: {
                        display: false,
                        text: 'Data',
                        color: 'black'
                    },
                    grid: {
                        display: false,
                        borderDash: [2],
                        borderDashOffset: 2,
                        color: 'rgba(33, 37, 41, 0.3)'
                    }
                },

                y: {
                    ticks: {
                        color: 'rgba(0,0,0,.7)'
                    },
                    display: true,
                    title: {
                        display: false,
                        text: 'Ilość punktów',
                        color: 'black'
                    },
                    grid: {
                        borderDash: [3],
                        borderDashOffset: 3,
                        drawBorder: false,
                        color: 'rgba(0, 0, 0, 0.15)'
                    }
                }
            },
            parsing: {
                xAxisKey: 'date',
                yAxisKey: 'points'
            }
        }
    };
};
