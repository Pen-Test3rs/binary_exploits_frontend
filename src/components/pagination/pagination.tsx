import React, { useState } from 'react';

interface paginationProps {
    data: JSX.Element[];
    pageLimit: number;
    dataLimit: number;
}

const Pagination = ({ data, pageLimit, dataLimit }: paginationProps) => {
    let pages = Math.ceil(data.length / dataLimit);
    const [currentPage, setCurrentPage] = useState(1);

    function goToNextPage() {
        setCurrentPage((page) => page + 1);
    }

    function goToPreviousPage() {
        setCurrentPage((page) => page - 1);
    }

    function changePage(event: React.MouseEvent<HTMLButtonElement>) {
        const pageNumber = Number((event.target as HTMLInputElement).textContent);
        setCurrentPage(pageNumber);
    }

    const getPaginatedData = () => {
        const startIndex = currentPage * dataLimit - dataLimit;
        const endIndex = startIndex + dataLimit;
        return data.slice(startIndex, endIndex);
    };

    const getPaginationGroup = () => {
        let start = Math.floor((currentPage - 1) / pageLimit) * pageLimit;
        let showingPages = pageLimit;
        if (start + pageLimit > pages) {
            showingPages = pages - start;
        }
        return new Array(showingPages).fill(0).map((_, idx) => start + idx + 1);
    };

    return (
        <div className="w-full">
            <div className="flex flex-wrap w-full">{getPaginatedData()}</div>
            <div className="flex flex-col items-center my-12">
                <div className="flex text-gray-700">
                    <button
                        onClick={goToPreviousPage}
                        className={
                            'h-12 w-12 mr-1 flex justify-center items-center rounded-full bg-gray-200 cursor-pointer disabled:opacity-50 focus:outline-none'
                        }
                        disabled={currentPage === 1}
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="100%"
                            height="100%"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                            strokeWidth="2"
                            strokeLinecap="round"
                            strokeLinejoin="round"
                            className="feather feather-chevron-left w-6 h-6"
                        >
                            <polyline points="15 18 9 12 15 6" />
                        </svg>
                    </button>
                    <div className="flex h-12 font-medium rounded-full bg-gray-200">
                        {getPaginationGroup().map((item, index) => (
                            <button
                                key={index}
                                onClick={changePage}
                                className={`w-12 md:flex justify-center items-center cursor-pointer leading-5 transition duration-150 ease-in focus:outline-none rounded-full  ${
                                    currentPage === item ? 'bg-blue-600 text-white' : ''
                                }`}
                            >
                                <span>{item}</span>
                            </button>
                        ))}
                    </div>
                    <button
                        onClick={goToNextPage}
                        className="h-12 w-12 ml-1 flex justify-center items-center rounded-full bg-gray-200 cursor-pointer disabled:opacity-50 focus:outline-none"
                        disabled={currentPage === pages}
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="100%"
                            height="100%"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                            strokeWidth="2"
                            strokeLinecap="round"
                            strokeLinejoin="round"
                            className="feather feather-chevron-right w-6 h-6"
                        >
                            <polyline points="9 18 15 12 9 6" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    );
};

export default Pagination;
