import { CgAttachment } from 'react-icons/all';
import React, { PropsWithChildren } from 'react';
import fileDownload from 'js-file-download';
import { attachmentService } from '../../services/attachmentService';
import { useToasts } from 'react-toast-notifications';

interface AttachmentInterface {
    href: string;
    onTaskModal?: boolean;
}

const Attachment = ({ href, children, onTaskModal }: PropsWithChildren<AttachmentInterface>) => {
    const filename = href.split('/').pop();
    const { addToast } = useToasts();

    return (
        <a
            href={href}
            className={`mb-2  ${onTaskModal ? 'attachment-badge-task' : 'attachment-badge'}`}
            onClick={(e) => {
                e.preventDefault();
                attachmentService
                    .get(href)
                    .then((res) => fileDownload(res, filename as string))
                    .catch(() =>
                        addToast('Wystąpił nieoczekiwany błąd', {
                            appearance: 'error'
                        })
                    );
            }}
        >
            <CgAttachment className={'inline-flex mr-1'} />
            {children}
        </a>
    );
};

export default Attachment;
