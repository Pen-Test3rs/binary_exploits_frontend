import React, { useEffect, useState } from 'react';
import TaskCard from './taskCard';
import Pagination from '../pagination/pagination';
import { Levels } from './levels';
import { tasksService } from '../../services/tasksService';
import { apiUrls } from '../../utils/apiUrls';
import { TasksList } from '../../models/task';

const TasksComponent = () => {
    const [tasks, setTasks] = useState<TasksList[]>([]);
    useEffect(() => {
        (async () => {
            tasksService
                .get(apiUrls.TASKS)
                .then((a) => {
                    setTasks(a);
                })
                .catch((err) => {
                    //TODO: handle error
                });
        })();
    }, []);

    let cards = [];
    /*let cards = [...Array(13)].map((e, i) => (
      <TaskCard
          key={i}
          category={'Przepełnienie bufora'}
          text={
              'Przepełnienie bufora – błąd programistyczny polegający na zapisaniu do wyznaczonego obszaru pamięci większej ilości danych niż zarezerwował na ten cel programista. Taka sytuacja prowadzi do zamazania danych znajdujących się w pamięci bezpośrednio za buforem, a w rezultacie do błędnego działania programu.'
          }
          level={Levels.Medium}
      />
  ));*/

    tasks.push({
        id: 29,
        name_id: 'buffer_overflow',
        labels: [],
        title: 'Przepełnienie bufora',
        level: Levels.Hard,
        points: 100,
        status: 'ok'
    });

    function wrapTasks() {
        return tasks.map((task) => (
            <TaskCard
                key={task.id}
                labels={task.labels}
                title={task.title}
                level={task.level}
                points={task.points}
                status={task.status}
            />
        ));
    }

    return (
        <>
            <div className="flex flex-wrap w-full">
                <Pagination data={wrapTasks()} pageLimit={Math.min(Math.ceil(tasks.length / 6), 5)} dataLimit={6} />
            </div>
        </>
    );
};

export default TasksComponent;
