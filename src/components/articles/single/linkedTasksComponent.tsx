import React from 'react';

import TaskCard from '../../tasks/single/taskCard';
import LinkedTasksContainer from '../../styled-components/articles/LinkedTasksContainer';
import { TaskCardData, taskComparator, TaskStatus } from '../../../models/task';
import TaskModal from '../../tasks/single/taskModal';
import { useModalData } from '../../tasks/useModalData';

const statusOrder = [TaskStatus.OK, TaskStatus.BLOCKED, TaskStatus.SOLVED];

interface LinkedTasksProps {
    linked_tasks: TaskCardData[];
}
const LinkedTasksComponent = ({ linked_tasks }: LinkedTasksProps) => {
    const modalData = useModalData();

    return (
        <LinkedTasksContainer>
            <TaskModal
                taskId={modalData.taskId}
                modalIsOpen={modalData.modalIsOpen}
                setModalIsOpen={modalData.setModalIsOpen}
            />
            <h3 className="text-center text-3xl mt-10 mb-4">PowiÄ…zane zadania</h3>
            <div className="grid gap-4 grid-cols-1 md:grid-cols-2 w-full">
                {linked_tasks
                    .sort(
                        (t1, t2) =>
                            statusOrder.indexOf(t1.status) - statusOrder.indexOf(t2.status) || taskComparator(t1, t2)
                    )
                    .map((task) => {
                        return <TaskCard key={task.id} taskData={task} openModal={modalData.openModal} />;
                    })}
            </div>
        </LinkedTasksContainer>
    );
};

export default LinkedTasksComponent;
