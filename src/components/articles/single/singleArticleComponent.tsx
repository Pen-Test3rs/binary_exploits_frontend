import { RouteComponentProps } from 'react-router-dom';
import React from 'react';
import { Article } from '../../../models/article';
import { articleService } from '../../../services/articleService';
import SingleArticleContent from './singleArticleContent';
import useAxiosEffect from '../../generic/useAxiosEffect';
import { useAppSelector } from '../../../context/hooks';
import { currentUserData } from '../../../context/userReducer';
import ScrollToTop from 'react-scroll-up';
import { HiChevronUp } from 'react-icons/all';
import { ComponentStateHandler } from '../../generic/componentStateHandler';

type TParams = {
    id: string;
};

const SingleArticleComponent = ({ match }: RouteComponentProps<TParams>) => {
    const id = match.params.id;
    const user = useAppSelector(currentUserData);

    const state = useAxiosEffect<Article>((opt) => articleService.getOne(id, opt), [id, user.solved]);
    const article = state.data as Article;

    return (
        <ComponentStateHandler state={state}>
            <ScrollToTop showUnder={500} style={{ zIndex: 10 }}>
                <HiChevronUp
                    className="text-5xl lg:mr-8 lg:mb-0 md:-mb-2 md:mr-4
                                   -mb-5 mr-0 text-gray-200 bg-gray-700
                                   bg-opacity-90 rounded-full"
                />
            </ScrollToTop>
            <SingleArticleContent article={article} />
        </ComponentStateHandler>
    );
};

export default SingleArticleComponent;
