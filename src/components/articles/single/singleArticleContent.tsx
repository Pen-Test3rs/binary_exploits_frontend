import React from 'react';

import { Article } from '../../../models/article';
import { markdown } from '../../../remarkable/remarkable';
import SingleArticleContainer from '../../styled-components/articles/SingleArticleContainer';
import TaskCard from '../../tasks/single/taskCard';
import LinkedTasksContainer from '../../styled-components/articles/LinkedTasksContainer';
import { TaskStatus } from '../../../models/task';

interface SingleArticleProps {
    article: Article;
}

const SingleArticleContent = ({ article }: SingleArticleProps) => {
    const statusOrder = [TaskStatus.OK, TaskStatus.BLOCKED, TaskStatus.SOLVED];

    const linkedTasksRenderer = (article: Article) => {
        return (
            <LinkedTasksContainer>
                <h3 className="text-center text-3xl mt-10 mb-4">PowiÄ…zane zadania</h3>
                <div className="grid gap-4 grid-cols-1 md:grid-cols-2 w-full">
                    {article.linked_tasks
                        .sort(
                            (a, b) =>
                                statusOrder.indexOf(a.status) - statusOrder.indexOf(b.status) || a.ordinal - b.ordinal
                        )
                        .map((task) => {
                            return <TaskCard taskData={task} key={task.id} />;
                        })}
                </div>
            </LinkedTasksContainer>
        );
    };

    return (
        <>
            <SingleArticleContainer>
                <h1 className="text-center text-4xl">{article.name}</h1>
                <div className="markdownContent">{markdown.render(article.content)}</div>
            </SingleArticleContainer>
            {article.linked_tasks && linkedTasksRenderer(article)}
        </>
    );
};

export default SingleArticleContent;
