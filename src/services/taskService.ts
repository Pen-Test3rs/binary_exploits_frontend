import { AxiosRequestConfig, AxiosResponse } from 'axios';
import axiosInstance from '../utils/axiosInterceptors';
import { Task, TaskCardData } from '../models/task';
import { apiUrls } from '../utils/apiUrls';
import { SolveData } from '../models/solveData';
import { ResponseFlagData } from '../models/responseFlagData';

const responseBody = (response: AxiosResponse) => response.data;

const getAll = async (options? :AxiosRequestConfig): Promise<TaskCardData[]> => {
    return axiosInstance.get(apiUrls.TASKS, options).then(responseBody);
};

const getOne = async (id: number, options? :AxiosRequestConfig): Promise<Task> => {
    const url = `${apiUrls.TASKS}${id}/`;
    return axiosInstance.get(url, options).then(responseBody);
};

const sendSolution = async (solveData: SolveData): Promise<ResponseFlagData> => {
    return axiosInstance.post(apiUrls.SOLVE, solveData).then(responseBody);
};

export const taskService = {
    getAll,
    getOne,
    sendSolution
};
